(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1042],{729:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/asistencia",function(){return n(32969)}])},44370:function(e,t,n){"use strict";n.d(t,{Hs:function(){return g},Sn:function(){return m},p4:function(){return h}});var a,s,r,o=n(34727),i=n(70655),c=n(42222),l=n(86455),u=n.n(l),d=n(98521),f=n(69706),g=(a=(0,o.Z)(function(){var e,t,n,a,s,r,o,l,g,h,m,b,p;return(0,i.__generator)(this,function(t){switch(t.label){case 0:return s=(0,c.get)(f.K6),r=(0,c.get)(f.zw),o=(0,c.get)(f.ay),l="1",(0,c.get)(f.wk),g=(0,c.get)(f.x),[4,d.az.AsistenciaEnFechasControl(g)];case 1:return h=t.sent(),[4,d.az.puedeCerrar(g)];case 2:return m=t.sent(),[4,d.az.getClaseDetalle(o,"CIERRE_SIN_ASIST")];case 3:if(b=t.sent(),console.log("PERMITIRRRRR____: ",b),console.log("PUEDEEEE____: ",m),console.log("AFC____:",h),!("A"!==r))return[3,10];if(h)return[3,7];if(!(b&&m))return[3,5];return[4,d.az.terminaSesionSolicitud(g,s,l)];case 4:return t.sent(),n=!0,[3,6];case 5:u().fire({title:"Portal de Docentes",text:"Antes de cerrar la sesi\xf3n debe registrar la asistencia de alumnos",icon:"warning",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}),t.label=6;case 6:return[3,9];case 7:return[4,d.az.terminaSesionSolicitud(g,s,l)];case 8:t.sent(),n=!0,t.label=9;case 9:return[3,12];case 10:return[4,d.az.terminaSesionSolicitud(g,s,l)];case 11:t.sent(),n=!0,t.label=12;case 12:if("R"!==e)return[3,14];return p={recoveryId:(0,c.get)(f.wk),states:"E",user:s},[4,d.az.actualizaRecuperacionEstado(p)];case 13:t.sent(),t.label=14;case 14:return[2,n]}})}),function(){return a.apply(this,arguments)}),h=(s=(0,o.Z)(function(e,t){var n,a,s,r,o,l,u,g,h,m,b,p,_,x,C;return(0,i.__generator)(this,function(i){switch(i.label){case 0:n=(0,c.get)(f.K6),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,d.az.listarCorreo_Solicitud(e,t)];case 2:return a=i.sent(),[4,d.az.trabajador(n)];case 3:return s=i.sent(),r=a.data,l=(o=s.data).lastName,u=o.middleLastName,g=o.name,h=o.email,m=(0,c.get)(f.uo),b=(0,c.get)(f.bo),_={EmailList:[r,h],DisplayName:"UPN Docentes",Subject:"Portal Docentes - Ingreso de Solicitud de Marcaci\xf3n",IsHtml:!0,ReplyToList:[h],AttachmentB64:null,AttachmentName:null,NotificationType:1,EmailListCC:null,EmailListBCC:null,Queue:!0,Body:"\n          <div>\n          <p>Estimado(s) Se\xf1or(es):</p>\n          <br/>\n          <p>Les informamos que se ingresado una nueva Solicitud de Marcaci\xf3n a trav\xe9s del Portal Docente.</p>\n          <br/>\n          <p>A continuaci\xf3n detallamos los datos de la solicitud:</p>\n          <br/>\n          <p>Docente : ".concat(g," ").concat(l," ").concat(u," </p>\n          <p>Clase No Marcada : ").concat(t,"</p>\n          <p>Fecha : ").concat(b,"</p>\n          <p>Motivo : ").concat(m,"</p>\n          </div>\n        ")},[4,d.az.email(_)];case 4:if(x=i.sent(),console.log("emailResp",x),"OK"===x||"200"===x)return[2,!0];return[3,6];case 5:return C=i.sent(),console.log(C),[3,6];case 6:return[2]}})}),function(e,t){return s.apply(this,arguments)}),m=(r=(0,o.Z)(function(){var e,t,n,a,s,r,o,l,g,h,m,b,p,_,x,C,w,A,S;return(0,i.__generator)(this,function(i){switch(i.label){case 0:if(e=(0,c.get)(f.vC),t=(0,c.get)(f.zw),n=(0,c.get)(f.ay),a=(0,c.get)(f.x),r=s=(0,c.get)(f.K6),l=(0,c.get)(f.wk),!("A"!==t))return[3,10];return[4,d.az.AsistenciaEnFechasControl(a)];case 1:return g=i.sent(),[4,d.az.puedeCerrar(a)];case 2:return h=i.sent(),[4,d.az.getClaseDetalle(n,"CIERRE_SIN_ASIST")];case 3:if(m=i.sent(),g)return[3,7];if(!(m&&h))return[3,5];return[4,d.az.terminaSesion(a,r)];case 4:return b=i.sent(),console.log("terminaSesion__",b.data.Status),o=!!b.data.Status,[3,6];case 5:o=!1,u().fire({title:"Portal de Docentes",text:"Antes de cerrar la sesi\xf3n debe registrar la asistencia de alumnos.",icon:"warning",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}),i.label=6;case 6:return[3,9];case 7:return[4,d.az.terminaSesion(a,r)];case 8:_=i.sent(),console.log("terminaSesion__",_.data.Status),o=!!_.data.Status,i.label=9;case 9:return[3,12];case 10:return[4,d.az.terminaSesion(a,r)];case 11:C=i.sent(),console.log("terminaSesion__",C.data.Status),o=!!C.data.Status,i.label=12;case 12:if("R"!==e)return[3,14];return A={recoveryId:l,states:"E",user:s},[4,d.az.actualizaRecuperacionEstado(A)];case 13:S=i.sent(),console.log("actualizaRecuperacionEstado__",S),i.label=14;case 14:return[2,o]}})}),function(){return r.apply(this,arguments)})},32969:function(e,t,n){"use strict";n.r(t);var a=n(34727),s=n(14251),r=n(52875),o=n(70655),i=n(85893),c=n(67294),l=n(50223),u=n(84555),d=n(56064),f=n(69672),g=n.n(f),h=n(57870),m=n(5152),b=n.n(m),p=n(42222),_=n(27201),x=n(86455),C=n.n(x),w=n(11163),A=n.n(w),S=n(30381),v=n.n(S),N=n(44370),E=n(98521),j=n(69706),z=b()(function(){return Promise.all([n.e(1427),n.e(8072),n.e(5489)]).then(n.bind(n,14146))},{loadableGenerated:{webpack:function(){return[14146]}},ssr:!1}),y=[{label:"Asistencia",field:"select",sort:"asc"},{label:"C\xf3d. alumno",field:"AluCodigo",sort:"asc"},{label:"Ap. paterno",field:"AluPaterno",sort:"asc"},{label:"Ap. materno",field:"AluMaterno",sort:"asc"},{label:"Nombres",field:"AluNombres",sort:"asc"},{label:"Carrera",field:"CarNombre",sort:"asc"},{label:"Vez",field:"MadeNroVeces",sort:"asc"},{label:"Clase",field:"ClaCodigo",sort:"asc"},{label:"Faltas",field:"NroFaltas",sort:"asc"},{label:"Estado",field:"MadeEstado",sort:"asc"},{label:"Tipo Clase",field:"ClaTipo",sort:"asc"},],B=function(){var e,t=(0,c.useState)([]),n=t[0],f=t[1],m=(0,c.useState)([]),b=m[0],x=m[1],w=(0,c.useState)(!1),S=w[0],B=w[1],T=(0,c.useState)(""),P=T[0],R=T[1],D=(0,c.useState)({btnSave:!1,btnCancel:!1}),I=D[0],K=D[1],k=(0,p.get)(j.K6),Z=(0,p.get)(j.tl),F=function(){(0,p.remove)(j.Ul),window.history.go(-2)};(0,c.useEffect)(function(){B(!0);var e=(0,p.get)(j.x);if(R(e),console.log(e),0===parseInt(e)){window.history.go(-1);return}var t,n=(t=(0,a.Z)(function(e){var t,n,a;return(0,o.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,E.az.listarAsistencia(e)];case 1:var c;return t=o.sent(),console.log("listarAsistencia__",t.data),t.data.length<1&&C().fire({title:"Se Produjo un error",text:"Esta clase no tiene alumnos asignados.",icon:"warning",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(e){window.history.go(-2)}),n=(c=t.data).map(function(e,t){return(0,r.Z)((0,s.Z)({},e),{select:(0,i.jsx)(d.Z,{idAlu:e.AluCodigo,datos:c,setDatos:x,defaultCheck:e.Asistencia,disabledbtn:Z===j.NL&&(K({btnSave:!0,btnCancel:!1}),!0)},t)})}),console.log("respItem__",n),f(n),B(!1),[3,3];case 2:return a=o.sent(),console.log(a),[3,3];case 3:return[2]}})}),function(e){return t.apply(this,arguments)});if(""===e)switch(Z){case j.Pw:A().push("/solicitud-de-marcacion");break;case j.bK:case j.NL:A().push("/sesiones-anteriores");break;default:A().push("/")}else n(e);f([])},[]);var M=(e=(0,a.Z)(function(){var e,t,a,s,r,i,c,l,u,d,f,g,h,m,_,w,A,S,z,y,T,R,D,I;return(0,o.__generator)(this,function(r){switch(r.label){case 0:switch(B(!0),e=(0,p.get)(j.tl),t=(0,p.get)(j.x),a=(0,p.get)(j.TA)&&""!==(0,p.get)(j.TA)?(0,p.get)(j.TA):0,e){case j.bK:return[3,1];case j.Pw:return[3,3]}return[3,4];case 1:return[4,E.az.AsistenciaEnFechasControl(t)];case 2:return s=!!r.sent(),[3,5];case 3:case 4:return s=!0,[3,5];case 5:if(console.log(s),console.log("datosAsis___",b.length),!(b.length>0))return[3,23];if(i=b.length>0,console.log("datosAsisCont",i),s&&(c=function(e){return e.map(function(e){var t=0;return"N"===e.Asistencia&&(t=1,console.log("N")),t})},l=[],i?l=c(b):(x(n),l=c(n)),l.filter(function(e){return 1===e}).length>0))return C().fire({title:"Portal de Docentes",text:"Se encontraron registros con asistencia = N Indique A, T o F",icon:"warning",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}),B(!1),[2];switch(f=function(e){return e.map(function(e){return'<asistencia \n						audit_usuario="'.concat(k,'" \n						s_alas_control="').concat(e.Asistencia,'" \n						s_cla_codigo="').concat(e.ClaCodigo,'" \n						s_alu_codigo="').concat(e.AluCodigo,'" \n						n_control_clase_id="').concat(P,'"\n					/>\n					')})},g=i?f(b):f(n),console.log(g),h="<registro>".concat(g.join(""),"</registro>"),console.log(h),m=h.replace(/ {2} |\r\n|\n|\r/gm,""),e){case j.bK:return[3,6];case j.Pw:return[3,10]}return[3,14];case 6:return r.trys.push([6,8,,9]),w=v()().format("YYYY-MM-DD"),[4,E.az.registraAsistencia(P,m,w,a)];case 7:return _=r.sent(),[3,9];case 8:return S=r.sent(),console.log(S),[3,9];case 9:case 13:case 14:return[3,15];case 10:return r.trys.push([10,12,,13]),[4,E.az.registraAsistenciasolicitud(P,m)];case 11:return _=r.sent(),[3,13];case 12:return y=r.sent(),console.log(y),[3,13];case 15:if(console.log(_),!("OK"===_||!0===_))return[3,22];r.label=16;case 16:if(r.trys.push([16,21,,22]),e!==j.Pw)return[3,20];return[4,(0,N.Hs)()];case 17:if(!r.sent())return[3,19];return R=(0,p.get)(j.ay),D=(0,p.get)(j.x),[4,(0,N.p4)(D,R)];case 18:r.sent(),r.label=19;case 19:(0,p.set)(j.eN,"1"),r.label=20;case 20:return B(!1),C().fire({title:"Portal de Docentes",text:"El Registro de Asistencia se ha guardado con \xe9xito",icon:"success",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}).then(function(e){(!0===e.isDismissed||!0===e.isConfirmed)&&window.history.go(-2),console.log(e)}),[3,22];case 21:return I=r.sent(),console.log(I),[3,22];case 22:return B(!1),[3,24];case 23:B(!1),C().fire({title:"Se produjo un error",text:"No ha realizado ninguna selecci\xf3n de asistencia.",icon:"warning",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"OK"}),r.label=24;case 24:return[2]}})}),function(){return e.apply(this,arguments)});return(0,i.jsxs)("div",{className:g().contenido,children:[(0,i.jsx)(_.Z,{loading:S}),(0,i.jsxs)("div",{className:g().content,children:[(0,i.jsx)("div",{className:g().titulo,children:(0,i.jsx)(h.Z,{classname:"text-warning h5 mt-3 mb-3",children:"Registro de asistencia"})}),(0,i.jsx)("hr",{}),(0,i.jsx)("div",{className:g().alertaContent,children:(0,i.jsx)(l.default,{classname:"w-100",variant:"info",children:(0,i.jsxs)("p",{className:"mb-0",children:[(0,i.jsx)("b",{children:"Nota:"})," \xa0Por defecto todos los alumnos no registran ning\xfan estado de asistencia ",(0,i.jsx)("b",{children:"(Asistencia = N)"}),". En listados grandes, ir grabando cada cierto tiempo."]})})}),(0,i.jsx)("div",{children:(0,i.jsxs)("small",{children:[(0,i.jsx)("strong",{children:"Indique: (A)"})," Asisti\xf3 / ",(0,i.jsx)("strong",{children:"(T)"})," Tard\xf3 /"," ",(0,i.jsx)("strong",{children:"(F)"})," Falt\xf3."]})}),(0,i.jsx)("hr",{}),(0,i.jsx)("div",{className:g().tabla,children:(0,i.jsx)(z,{columns:y,listData:n,pagination:!1})}),(0,i.jsxs)("div",{className:g().botones,children:[(0,i.jsx)("div",{children:(0,i.jsx)(u.Z,{type:"button",variant:"primary",onclick:M,disabled:I.btnSave,children:"Guardar Registro"})}),(0,i.jsx)("div",{children:(0,i.jsx)(u.Z,{type:"button",variant:"secondary",disabled:I.btnCancel,onclick:F,children:"Cancelar"})})]})]})]})};B.title="Asistencia - Portal Docentes",t.default=B},11163:function(e,t,n){e.exports=n(90387)}},function(e){e.O(0,[4885,6006,8620,8287,9774,2888,179],function(){return e(e.s=729)}),_N_E=e.O()}]);